amends "package://github.com/jdx/hk/releases/download/v1.26.0/hk@1.26.0#/Config.pkl"
import "package://github.com/jdx/hk/releases/download/v1.26.0/hk@1.26.0#/Builtins.pkl"

local backendLinters = new Group {
  steps {
    // uses builtin prettier linter config
    ["golangci-lint"] = (Builtins.golangci_lint) {
      dir = "backend"
      types = List("go")
      check = "mise run checks"
      fix = "mise run checks --fix"
    }
  }
}

local backendTests = new Group {
  steps {
    // uses builtin prettier linter config
    ["golangci-lint"] = (Builtins.golangci_lint) {
      dir = "backend"
      types = List("go")
      check = "mise run checks"
      fix = "mise run checks --fix"
    }
  }
}

hooks {
    ["pre-commit"] {
        fix = true    // automatically modify files with available linter fixes
        stash = "git" // stashes unstaged changes while running fix steps
        steps {
          ["backend"] = backendLinters
        }
    }
    // instead of pre-commit, you can instead define pre-push hooks
    ["pre-push"] {
        steps {
          ["backend"] = backendLinters
        }
    }

    ["fix"] {
        fix = true
        steps {
          ["backend"] = backendLinters
        }
    }
    ["check"] {
        steps {
          ["backend"] = backendLinters
        }
    }
    ["test"] {
        steps {
          ["backend"] = backendTests
        }
    }

}
