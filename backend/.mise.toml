[env]
CGO_ENABLED = "0"

[tools]
air = "latest"
go = "latest"
golangci-lint = "latest"

[tasks.fill-db]
description = "Fill database"
run = """
rm -f ./bin/app.db
go run scripts/fill_db/fill_db.go
"""

[tasks.app]
description = "Run the application"

[tasks.checks]
description = "Run checks"
sources = [
    "./**/*.go",
]
usage = '''
flag "--fix" {
    help "Enable automatic fixes"
}
'''
run = '''
set -x
golangci-lint run --config .golangci.yml ./... ${usage_fix:+--fix}
'''

[tasks.tests]
description = "Run tests"
run = "go test -cover ./... -coverpkg=./..."

[tasks.coverage]
description = "Run coverage"
run = "go test -cover -coverprofile=profile.cov ./... && go tool cover -func=profile.cov"
